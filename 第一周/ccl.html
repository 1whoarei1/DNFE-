<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BigData - 首页</title>
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <!-- 粒子特效 -->
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <!-- 动画库 -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
    <!-- 自定义样式 -->
    <link rel="stylesheet" href="master.css">
    <style>
        /* 粒子特效容器样式*/
        #particles-js {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 4;
        }
        /* 登录用户信息样式*/
        .user-info-wrapper {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 20px;
            cursor: default;
        }
        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 28px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .user-details {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #fff;
        }
        .user-name {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 4px;
        }
        .logout-btn {
            background: none;
            border: 1px solid rgba(255, 255, 255, 0.5);
            color: #fff;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .logout-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: #fff;
        }
        /* 登陆后隐藏未登录的登录入口*/
        .iconLogin {
            display: none !important;
        }
    </style>
</head>

<body>
    <div id="menu-bars" class="fas fa-bars"></div>
    <header>
        <h2 class="logo">BigData</h2>
        <!-- 子页面结构-->
        <nav class="navigation">
            <a href="./子页面a/a.html">子页面</a>
            <a href="./子页面b/b.html">子页面</a>
            <a href="./子页面c/c.html">子页面</a>
            <a href="./子页面d/d.html">子页面</a>
            <ul class="dropdown">
                <li>
                    <a href="#">有子项的子页面</a>
                    <ul class="submenu">
                        <li><a href="./子项/子项1/01.html">子项</a></li>
                        <li><a href="./子项/子项2/02.html">子项</a></li>
                    </ul>
                </li>
            </ul>
            <a href="./About Us/About Us.html">About Us</a>
        </nav>
        <!-- 登录用户信息区-->
        <div id="profileCenter" style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 120px; margin-top: 10px;">
            <!-- 未登录时的登录入口，已隐藏，仅作兼容） -->
            <a href="./login/login.html"><span class="iconLogin" style="font-size: 60px; margin-bottom: -20px;"><ion-icon name="person-circle-outline"></ion-icon></span></a> 
            <!-- 登录后的用户信息-->
            <div id="loggedInUserInfo" class="user-info-wrapper" style="display: none;">
                <div class="user-avatar">
                    <ion-icon name="person-circle"></ion-icon>
                </div>
                <div class="user-details">
                    <div class="user-name" id="displayUsername"></div>
                    <button class="logout-btn" id="logoutButton">退出登录</button>
                </div>
            </div>
        </div>
    </header>

    <!-- 视差特效、背景图-->
    <main>
        <div class="vignette"></div>
        <img src="img/BACKGROUND1.jpg" data-speedx="0.03" data-speedy="0.015" data-speedz="0.01" class="parallax bg-img">
        <img src="img/person1.png" data-speedx="0.05" data-speedy="0.08" data-speedz="0.05" class="parallax person1">
        <img src="img/person2.png" data-speedx="0.08" data-speedy="0.08" data-speedz="0.02" class="parallax person2">
        <img src="img/TEXT.png" data-speedx="0.08" data-speedy="0.08" data-speedz="0.02" class="parallax TEXT">
        <img src="img/mountain1.png" data-speedx="0.013" data-speedy="0.08" data-speedz="0.1" class="parallax mountain1">
        <img src="img/person3.png" data-speedx="0.05" data-speedy="0.12" data-speedz="0.05" class="parallax person3">
    </main>

    <!--视差、粒子特效文件-->
    <script src="app1.js"></script>
    <script src="./login/login.js"></script>
    <div id="particles-js"></div>
    <script>
        // 粒子特效
        particlesJS('particles-js', {
            "particles": {
                "number": { "value": 100 },
                "color": { "value": "#ffffff" },
                "shape": { "type": "circle" },
                "opacity": { "value": 0.5 },
                "size": { "value": 3 },
                "line_linked": {
                    "enable": true,
                    "distance": 150,
                    "color": "#ffffff",
                    "opacity": 0.4,
                    "width": 1
                },
                "move": { "enable": true, "speed": 6 }
            },
            "interactivity": {
                "events": {
                    "onhover": { "enable": true, "mode": "repulse" },
                    "onclick": { "enable": true, "mode": "push" }
                },
                "modes": {
                    "repulse": { "distance": 150 },
                    "push": { "particles_nb": 4, "distance": 80 }
                }
            },
            "retina_detect": true
        }, function() {
            console.log('Particles.js loaded - callback');
        });

        // 登录状态控制
        document.addEventListener('DOMContentLoaded', function() {
            // 从本地存储获取登录用户信息
            const loggedInUser = localStorage.getItem('loggedInUser');
            const userInfoContainer = document.getElementById('loggedInUserInfo');
            const usernameDisplay = document.getElementById('displayUsername');
            const logoutButton = document.getElementById('logoutButton');

            // 登陆后显示用户信息，隐藏登录入口
            if (loggedInUser) {
                usernameDisplay.textContent = loggedInUser; //用户名
                userInfoContainer.style.display = 'flex';   // 用户信息区域
            } else {
                //未登录，重定向到登录页，确保未登录无法访问首页
                window.location.href = './login/login.html';
            }

            // 退出登录功能
            logoutButton.addEventListener('click', function() {
                // 清除本地存储的登录状态
                localStorage.removeItem('loggedInUser');
                // 重定向到登录页
                window.location.href = './login/login.html';
            });
        });
    </script>
</body>
</html>